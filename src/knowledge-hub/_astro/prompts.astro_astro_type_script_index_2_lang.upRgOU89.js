import{i as b,x as m}from"./lit-element.CBixG2jI.js";class u extends b{static properties={category:{type:Array,state:!0},subcategory:{type:Array,state:!0},organisation:{type:Array,state:!0},governmentBody:{type:Array,state:!0},verifiedByProfession:{type:Array,state:!0}};createRenderRoot(){return this.innerHTML="",this}constructor(){super(),Object.keys(u.properties).forEach(e=>{this[e]=[]})}connectedCallback(){super.connectedCallback(),Object.keys(u.properties).forEach(e=>{const s=e.replace(/([A-Z])/g,"-$1").toLowerCase();if(document.querySelectorAll(".kh-card").forEach(t=>{const i=t.getAttribute(`data-${s}`);i&&i.split(/[/;]+/)?.forEach(y=>{let d=y.trim().trimStart();if(d&&!this[e].includes(d)){if(this[e].push(d),e==="category"){const h=t.getAttribute("data-profession");h&&!this.category.includes(h)&&this.category.push(h)}e==="subcategory"&&d==="Personal productivity"&&!this.category.includes(d)&&this.category.push(d)}})}),e==="governmentBody"){const t=["UK Government","Scottish Government","Welsh Government","Northern Ireland Executive","Local Government"];this.governmentBody.sort((i,n)=>t.indexOf(i)-t.indexOf(n))}else if(e==="typeOfTechnology"){const t=["Generative AI","Machine Learning","Data or Infrastructure"];this.typeOfTechnology.sort((i,n)=>t.indexOf(i)-t.indexOf(n))}else if(e==="userGroup"){const t=["General Public","Civil Servants","Wider Public Sector"];this.userGroup.sort((i,n)=>t.indexOf(i)-t.indexOf(n))}else this[e].sort()})}firstUpdated(){const e=()=>{Object.keys(u.properties).forEach(s=>{const c=new URL(window.location.href).searchParams.get(s),t=this.querySelector(`#${s}`);t&&(t.value=c||"")}),this.applyFilters()};window.addEventListener("popstate",e),e()}render(){const e={category:"Task",subcategory:"Subtask",organisation:"Organisation",governmentBody:"Government body",verifiedByProfession:"Verified by function"};return m`
      <div class="govuk-grid-row">
        ${Object.keys(u.properties).map(s=>this[s].length>0?m`
            <div class="govuk-grid-column-full govuk-grid-column-one-half-from-desktop govuk-grid-column-one-quarter-from-large-desktop">
              <div class="govuk-form-group">
                <label class="govuk-label" for="${s}" style="text-transform: capitalize;">${e[s]}</label>            
                <select @change=${()=>this.applyFilters(s==="category")} class="govuk-select" id="${s}" ?disabled=${s==="subcategory"} style="width: 100%;">
                  <option value="" ?selected=true>All</option>
                  ${this[s].map(c=>m`
                    <option value="${c}">${c}</option>
                  `)}
                </select>
              </div>
            </div>
          `:null)}
      </div>
    `}applyFilters(e=!1){const s=new URL(window.location.href);Object.keys(u.properties).map(r=>{let l=this.querySelector(`#${r}`)?.value;s.searchParams.set(r,l)}),window.history.pushState({},"",s);const c=document.querySelectorAll(".kh-card"),t=document.querySelector("#filtered-count"),i=document.querySelector("#active-filters");let n=0;const y=[];Object.keys(u.properties).forEach(r=>{let l=this.querySelector(`#${r}`)?.value;if(l){const a=r.replace(/([A-Z])/g," $1").trim().toLowerCase();y.push(`${a}: <strong>${l}</strong>`)}});const d=window.location.pathname.split("/").includes("prompts")?"prompts":"tools",h=y.join(", ").replace(/<strong>/g,"").replace(/<\/strong>/g,"").trim();posthog.capture("kh_filters_applied",{filters:h,page_type:d}),c.forEach(r=>{let l=!0;Object.keys(u.properties).map(a=>{let o=this.querySelector(`#${a}`)?.value;if(o)if(a==="category"&&o==="Project management"){const g=r.getAttribute("data-profession");(!g||!g.trim().includes("Project management"))&&(l=!1)}else if(a==="category"&&o==="Personal productivity"){const g=r.getAttribute("data-subcategory");(!g||!g.includes("Personal productivity"))&&(l=!1)}else{const g=a.replace(/([A-Z])/g,"-$1").toLowerCase(),p=r.getAttribute(`data-${g}`);(!p||!p.includes(o))&&(l=!1)}}),l?(r.classList.remove("hidden"),n++):r.classList.add("hidden")});const f=document.querySelector("#subcategory"),v=document.querySelector("#category");if(f){if(v?.value==="")f.disabled=!0,f.value="";else if(v?.value){f.disabled=!1;const r=[];Array.from(c).filter(a=>{if(v.value==="Project management"){const o=a.getAttribute("data-profession");return o&&o.trim().includes("Project management")}else if(v.value==="Personal productivity"){const o=a.getAttribute("data-subcategory");return o&&o.includes("Personal productivity")}else return a.getAttribute("data-category")===v.value}).forEach(a=>{const o=a.getAttribute("data-subcategory");o&&!r.includes(o)&&r.push(o)}),this.subcategory=r,r.length===1&&(f.value="",f.disabled=!0)}}if(e&&f&&(f.value=""),!!t&&(n===c.length?t.textContent="all":t.textContent=n.toString(),i))if(y.length>0){const r=y.join(", ");i.innerHTML=` filtered by ${r}`}else i.innerHTML=""}}customElements.define("usecase-filters",u);
