import{i as b,x as m}from"./lit-element.CBixG2jI.js";class u extends b{static properties={category:{type:Array,state:!0},subcategory:{type:Array,state:!0},organisation:{type:Array,state:!0},governmentBody:{type:Array,state:!0},verifiedByProfession:{type:Array,state:!0}};createRenderRoot(){return this.innerHTML="",this}constructor(){super(),Object.keys(u.properties).forEach(e=>{this[e]=[]})}connectedCallback(){super.connectedCallback(),Object.keys(u.properties).forEach(e=>{const i=e.replace(/([A-Z])/g,"-$1").toLowerCase();if(document.querySelectorAll(".kh-card").forEach(r=>{const s=r.getAttribute(`data-${i}`);s&&s.split(/[/;]+/)?.forEach(y=>{let d=y.trim().trimStart();if(d&&!this[e].includes(d)){if(this[e].push(d),e==="category"){const h=r.getAttribute("data-profession");h&&!this.category.includes(h)&&this.category.push(h)}e==="subcategory"&&d==="Personal productivity"&&!this.category.includes(d)&&this.category.push(d)}})}),e==="governmentBody"){const r=["UK Government","Scottish Government","Welsh Government","Northern Ireland Executive","Local Government"];this.governmentBody.sort((s,l)=>r.indexOf(s)-r.indexOf(l))}else if(e==="typeOfTechnology"){const r=["Generative AI","Machine Learning","Data or Infrastructure"];this.typeOfTechnology.sort((s,l)=>r.indexOf(s)-r.indexOf(l))}else if(e==="userGroup"){const r=["General Public","Civil Servants","Wider Public Sector"];this.userGroup.sort((s,l)=>r.indexOf(s)-r.indexOf(l))}else this[e].sort()})}firstUpdated(){const e=()=>{Object.keys(u.properties).forEach(a=>{const r=new URL(window.location.href).searchParams.get(a),s=this.querySelector(`#${a}`);s&&(s.value=r||"")}),this.applyFilters()};window.addEventListener("popstate",e),e(),document.querySelectorAll(".kh-filter-select").forEach(a=>{a.value=""})}render(){const e={category:"Task",subcategory:"Subtask",organisation:"Organisation",governmentBody:"Government body",verifiedByProfession:"Verified by function"};return m`
      <div class="govuk-grid-row">
        ${Object.keys(u.properties).map(i=>this[i].length>0?m`
            <div class="govuk-grid-column-full govuk-grid-column-one-half-from-desktop govuk-grid-column-one-quarter-from-large-desktop">
              <div class="govuk-form-group">
                <label class="govuk-label" for="${i}" style="text-transform: capitalize;">${e[i]}</label>            
                <select @change=${()=>this.applyFilters(i==="category")} class="govuk-select kh-filter-select" id="${i}" ?disabled=${i==="subcategory"} style="width: 100%;">
                  <option value="">All</option>
                  ${this[i].map(a=>m`
                    <option value="${a}">${a}</option>
                  `)}
                </select>
              </div>
            </div>
          `:null)}
      </div>
    `}applyFilters(e=!1){const i=new URL(window.location.href);Object.keys(u.properties).map(t=>{let c=this.querySelector(`#${t}`)?.value;i.searchParams.set(t,c)}),window.history.pushState({},"",i);const a=document.querySelectorAll(".kh-card"),r=document.querySelector("#filtered-count"),s=document.querySelector("#active-filters");let l=0;const y=[];Object.keys(u.properties).forEach(t=>{let c=this.querySelector(`#${t}`)?.value;if(c){const n=t.replace(/([A-Z])/g," $1").trim().toLowerCase();y.push(`${n}: <strong>${c}</strong>`)}});const d=window.location.pathname.split("/").includes("prompts")?"prompts":"tools",h=y.join(", ").replace(/<strong>/g,"").replace(/<\/strong>/g,"").trim();posthog.capture("kh_filters_applied",{filters:h,page_type:d}),a.forEach(t=>{let c=!0;Object.keys(u.properties).map(n=>{let o=this.querySelector(`#${n}`)?.value;if(o)if(n==="category"&&o==="Project management"){const g=t.getAttribute("data-profession");(!g||!g.trim().includes("Project management"))&&(c=!1)}else if(n==="category"&&o==="Personal productivity"){const g=t.getAttribute("data-subcategory");(!g||!g.includes("Personal productivity"))&&(c=!1)}else{const g=n.replace(/([A-Z])/g,"-$1").toLowerCase(),p=t.getAttribute(`data-${g}`);(!p||!p.includes(o))&&(c=!1)}}),c?(t.classList.remove("hidden"),l++):t.classList.add("hidden")});const f=document.querySelector("#subcategory"),v=document.querySelector("#category");if(f){if(v?.value==="")f.disabled=!0,f.value="";else if(v?.value){f.disabled=!1;const t=[];Array.from(a).filter(n=>{if(v.value==="Project management"){const o=n.getAttribute("data-profession");return o&&o.trim().includes("Project management")}else if(v.value==="Personal productivity"){const o=n.getAttribute("data-subcategory");return o&&o.includes("Personal productivity")}else return n.getAttribute("data-category")===v.value}).forEach(n=>{const o=n.getAttribute("data-subcategory");o&&!t.includes(o)&&t.push(o)}),this.subcategory=t,t.length===1&&(f.value="",f.disabled=!0)}}if(e&&f&&(f.value=""),!!r&&(l===a.length?r.textContent="all":r.textContent=l.toString(),s))if(y.length>0){const t=y.join(", ");s.innerHTML=` filtered by ${t}`}else s.innerHTML=""}}customElements.define("usecase-filters",u);
