---
layout: base.njk
templateEngineOverride: njk
pagination:
    data: blogs
    size: 1
    alias: blog
permalink: "blogs/{{ blog.title | slugify }}/"
# Note: If permalink changes - also update in base.njk
---

{% from "./_includes/blog-author.njk" import blogAuthor %}
{% from "./_includes/blog-header.njk" import blogHeader %}
{% from "./_includes/video.njk" import video %}


{{ blogHeader() }}

<div class="iai-blog-title container">
    <h2 class="iai-blog-title__title">{{ blog.title }}</h2>
    <p class="iai-blog-title__date">{{ blog.date | dateFormat }}</p>
    <div class="d-md-flex gap-5">
        {% for author in blog.authors %}
            {{ blogAuthor (author, "large") }}
        {% endfor %}
    </div>
    {% if blog.summaryLong %}
        <p class="iai-blog-title__summary">{{ blog.summaryLong }}</p>
    {% endif %}
</div>

<div class="iai-blog-content container">
    
    <div class="iai-blog-content__inner-container">

        <div class="iai-blog-title__cover-image-container">
            {% if blog.coverImage.title %}
                <figure>
                    <img class="iai-blog-title__cover-image" src="{{ blog.coverImage.file.url }}?w=1536" alt="{{ blog.coverImage.description }}"/>
                    <figcaption class="iai-blog-title__figcaption">{{ blog.coverImage.title }}</figcaption>
                </figure>
            {% else %}
                <img class="iai-blog-title__cover-image" src="{{ blog.coverImage.file.url }}?w=1536" alt="{{ blog.coverImage.description }}"/>
            {% endif %}
        </div>

        <div id="content">
            {% if blog.source === "Contentful" %}
                {{ blog.content | richTextToHTML | safe }}
            {% else %}
                {% for component in blog.components %}
                    {% if component.type == "bodyText" %}
                        {{ component.content | markdownToHtml | safe }}
                    {% elif component.type == "video" %}
                        {{ video({
                            classes: "iai-promo-video",
                            source: component.source,
                            audioDescription: component.audioDescription
                        }) }}
                    {% endif %}
                {% endfor %}
            {% endif %}
        </div>

    </div>

    {# Custom blog components #}
    {% if blog.title == "The i.AI Taxonomy" %}
        {% from "./_includes/blog-components/project-types.njk" import projectTypes %}
        {{ projectTypes() }}
    {% endif %}
    {% if blog.title == "Improving Legislative Drafting with Lex" %}
        <div class="iai-blog-content__inner-container">
            {% from "./_includes/blog-components/lex-slide.njk" import lexSlide %}
            {{ lexSlide() }}
        </div>
    {% endif %}
    {% if blog.title == "Singapore" %}
        {% from "./_includes/blog-components/box-out.njk" import boxOut %}
        {{ boxOut(
            '<h2><img src="/img/launchpad_logo.png" alt="Launchpad" loading="lazy" width="220"/></h2><p>The Launchpad operates within GovTech, fostering innovation through ideathons and engaging with various government agencies. Over 500 ideas have been collected, with four agencies currently engaged and more in the pipeline.Target audience includes transformation teams and public officers, with a six-month timeline comprising a launch, sprints, and a final release. A web page facilitates idea submissions, leveraging LLMs for detail expansion, community upvoting, and direct links to prototypes.</p>'
        ) }}
    {% endif %}

    {% if blog.contentPart2 %}
        <div class="iai-blog-content__inner-container">
            {{ blog.contentPart2 | richTextToHTML | safe }} 
        </div>
    {% endif %}

    {# Preview demo #}
    <script>

        const convertDate = (dateStr) => {
            const months = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];
            const suffixes = ["th", "st", "nd", "rd"];
            function getDaySuffix(day) {
                if (day > 3 && day < 21) return "th"; // Covers 11th, 12th, 13th
                switch (day % 10) {
                    case 1: return suffixes[1];
                    case 2: return suffixes[2];
                    case 3: return suffixes[3];
                    default: return suffixes[0];
                }
            }
            const [year, month, day] = dateStr.split('-');
            if (!year || !month || !day) {
                return "";
            }
            const dayNumber = parseInt(day, 10);
            const monthName = months[parseInt(month, 10) - 1];
            const daySuffix = getDaySuffix(dayNumber);
            return `${dayNumber}${daySuffix} ${monthName} ${year}`;
        }

        const updateContent = () => {
            document.querySelector(".iai-blog-title__title").textContent = parent.parent.document.querySelector("input")?.value || "[Blog title]";
            
            const date = parent.parent.document.querySelector('input[type="date"]')?.value;
            document.querySelector(".iai-blog-title__date").textContent = convertDate(date) || "[Date goes here]";
            
            document.querySelector(".iai-blog-title__summary").textContent = parent.parent.document.querySelector("textarea")?.value || "";
            document.querySelector("#content").innerHTML = parent.parent.document.querySelector('[role="textbox"]')?.innerHTML || "[Content to go here]";
            let unwantedElements = document.querySelectorAll("#content button, #content label");
            unwantedElements.forEach((unwantedElement) => {
                unwantedElement.remove();
            });
            document.querySelector(".iai-blog-title__cover-image").src = parent.parent.document.querySelector('img[role="presentation"]')?.src || "http://images.ctfassets.net/6kma07ky7db0/1XcpSnasKxYkoGcikH35Sx/23eea9f19c2cc885bc5c5040fcd7df4d/Frame_3__1_.png?w=1536"
            window.setTimeout(updateContent, 500);
        };
        window.addEventListener("DOMContentLoaded", () => {
            if (window.location.search.includes("preview=true")) {
                document.querySelector("header").remove();
                document.querySelector(".iai-blog-author__image").src = "https://t4.ftcdn.net/jpg/00/93/85/69/360_F_93856984_YszdhleLIiJzQG9L9pSGDCIvNu5GEWCc.jpg";
                document.querySelector(".iai-blog-author__name").textContent = "Author (not available in preview)";
                document.querySelector(".iai-blog-author__job").textContent = "Job title";
                document.querySelector("main").style.paddingTop = "0";
                document.querySelector("main").style.paddingBottom = "2rem";
                document.querySelector("footer").remove();
                updateContent();
            }
        });
    </script>

</div>

